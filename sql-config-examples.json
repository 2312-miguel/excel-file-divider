{
  "inputFile": "data/ejemplo.xlsm",
  "sheetName": "Hoja1",
  "tableName": "contracts",
  "outputDir": "sql_output",
  "sqlType": "UPDATE",
  "whereColumn": "ID",
  
  "tableRelations": {
    "contactos": {
      "joinType": "INNER",
      "joinCondition": {
        "excelColumns": ["Nombre", "Apellido"],
        "sqlColumns": ["nombre", "apellido1", "apellido2"],
        "concatenation": {
          "excel": {
            "separator": " ",
            "columns": ["Nombre", "Apellido"]
          },
          "sql": {
            "separator": " ",
            "columns": ["nombre", "apellido1", "apellido2"]
          }
        }
      }
    }
  },

  "columnMapping": {
    "Cod": "nro",
    "Plan": "plan_nombre",
    "Cliente": "nombre_cliente",
    "Fecha": "fecha_facturacion",
    "Monto": "monto_total",
    "Estado": "estado_contrato"
  },

  "filters": [
    {
      "column": "Plan",
      "operator": "equals",
      "value": "PLAN FAMILIAR"
    },
    {
      "column": "Plan",
      "operator": "contains",
      "value": "PLAN"
    },
    {
      "column": "Plan",
      "operator": "containsExclude",
      "value": "PLAN FAM",
      "exclude": "mb"
    },
    {
      "column": "Cliente",
      "operator": "startsWith",
      "value": "Juan"
    },
    {
      "column": "Cliente",
      "operator": "endsWith",
      "value": "Pérez"
    },
    {
      "column": "Monto",
      "operator": "greaterThan",
      "value": 1000
    },
    {
      "column": "Monto",
      "operator": "lessThan",
      "value": 5000
    }
  ]
}

/* 
Ejemplos de sentencias SQL generadas:

1. UPDATE simple:
UPDATE contracts
SET `nro` = '123',
    `plan_nombre` = 'PLAN FAMILIAR',
    `nombre_cliente` = 'Juan Pérez',
    `fecha_facturacion` = '2024-03-20',
    `monto_total` = 1500,
    `estado_contrato` = 'ACTIVO'
WHERE `ID` = 123;

2. UPDATE con JOIN:
UPDATE contracts t
INNER JOIN contactos c ON CONCAT(`nombre`, `apellido1`, `apellido2`) = 'Juan Pérez García'
SET `nro` = '123',
    `plan_nombre` = 'PLAN FAMILIAR',
    `nombre_cliente` = 'Juan Pérez',
    `fecha_facturacion` = '2024-03-20',
    `monto_total` = 1500,
    `estado_contrato` = 'ACTIVO'
WHERE t.`ID` = 123;

Operadores de filtro disponibles:
- equals: Coincidencia exacta
- contains: Contiene el texto
- containsExclude: Contiene el texto pero excluye otro
- startsWith: Comienza con el texto
- endsWith: Termina con el texto
- greaterThan: Mayor que el valor
- lessThan: Menor que el valor

Tipos de JOIN disponibles:
- INNER: Solo registros que coinciden en ambas tablas
- LEFT: Todos los registros de la tabla principal y los que coinciden
- RIGHT: Todos los registros de la tabla secundaria y los que coinciden
*/ 